{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport * as R from 'ramda';\nimport { Details } from \"../../components/blog/Details\";\nimport Error from 'next/error';\nimport getConfig from 'next/config';\nimport { isServer } from \"../../components/common/helpers\";\nimport { Men } from \"../../components/home/Men\";\nimport Prismic from 'prismic-javascript';\nimport { prismicClient } from \"../../components/common/helpers\";\nimport { useRouter } from 'next/router';\nimport { Women } from \"../../components/home/Women\";\nconst {\n  publicRuntimeConfig\n} = getConfig();\n\nconst blogHost = () => publicRuntimeConfig.NEXT_PUBLIC_BLOG_URL.replace(/https?:\\/\\//, '');\n\nconst Home = props => {\n  const router = useRouter();\n  if (props.host === blogHost()) return __jsx(Details, props);else if (router.query.gender === 'men') return __jsx(Men, props);else if (router.query.gender === 'women') return __jsx(Women, props);\n  return __jsx(Error, {\n    statusCode: 404\n  });\n};\n\nexport const getServerSideProps = async params => {\n  // Blog and the main app are hosted on different domains\n  if ((isServer() ? params.req.headers.host : location.host) === blogHost()) return await Details.getServerSideProps(R.assocPath(['query', 'slug'], params.query.gender, params));\n  if (!R.includes(params.query.gender, ['men', 'women'])) params.res.statusCode = 404;\n  const topPostsResponse = await prismicClient(params.req).query([Prismic.Predicates.at('document.type', 'post'), Prismic.Predicates.at('my.post.is_top', true)], {\n    orderings: '[my.post.date desc]'\n  });\n  return {\n    props: {\n      cmsContent: R.path(['results', '0', 'data'], await prismicClient(params.req).query([Prismic.Predicates.at('document.id', params.query.gender === 'women' ? publicRuntimeConfig.NEXT_PUBLIC_PRISMIC_WOMENSHOMEPAGE_ID : publicRuntimeConfig.NEXT_PUBLIC_PRISMIC_MENSHOMEPAGE_ID)], {})),\n      topPosts: R.map(result => R.mergeRight(result.data, {\n        tags: result.tags,\n        uid: result.uid\n      }), topPostsResponse.results)\n    }\n  };\n};\nexport default Home;","map":null,"metadata":{},"sourceType":"module"}